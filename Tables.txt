CREATE SCHEMA CarRentalCompany;
USE CarRentalCompany;

CREATE TABLE Users (
    UserID INT AUTO_INCREMENT PRIMARY KEY,
    FirstName VARCHAR(50) NOT NULL,
    LastName VARCHAR(50) NOT NULL,
    Email VARCHAR(100) UNIQUE NOT NULL,
    Password VARCHAR(255) NOT NULL,
    PhoneNumber VARCHAR(15),
    Address VARCHAR(255),
    DriverLicenseID VARCHAR(50),
    UserType ENUM('Customer', 'Admin') DEFAULT 'Customer'
);

CREATE TABLE Offices (
    OfficeID INT AUTO_INCREMENT PRIMARY KEY,
    OfficeName VARCHAR(100) NOT NULL,
    Location VARCHAR(255) NOT NULL
);


CREATE TABLE Cars (
    CarID INT AUTO_INCREMENT PRIMARY KEY,
    Model VARCHAR(100) NOT NULL,
    Year INT NOT NULL,
    PlateID VARCHAR(20) UNIQUE NOT NULL,
    Status ENUM('Active', 'Out of Service', 'Rented') DEFAULT 'Active',
    OfficeID INT,
    PricePerDay DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (OfficeID) REFERENCES Offices(OfficeID) ON DELETE SET NULL
);

CREATE TABLE Reservations (
    ReservationID INT AUTO_INCREMENT PRIMARY KEY,
    UserID INT NOT NULL,
    CarID INT NOT NULL,
    ReservationDate DATETIME DEFAULT CURRENT_TIMESTAMP,
    PickupDate DATE NOT NULL,
    ReturnDate DATE NOT NULL,
    TotalPayment DECIMAL(10, 2) NOT NULL,
    Status ENUM('Reserved', 'Completed', 'Cancelled') DEFAULT 'Reserved',
    FOREIGN KEY (UserID) REFERENCES Users(UserID) ON DELETE CASCADE,
    FOREIGN KEY (CarID) REFERENCES Cars(CarID) ON DELETE CASCADE
);

CREATE TABLE Payments (
    PaymentID INT AUTO_INCREMENT PRIMARY KEY,
    ReservationID INT NOT NULL,
    Amount DECIMAL(10, 2) NOT NULL,
    PaymentDate DATETIME DEFAULT CURRENT_TIMESTAMP,
    PaymentMethod ENUM('Credit Card', 'Cash', 'Bank Transfer') DEFAULT 'Credit Card',
    FOREIGN KEY (ReservationID) REFERENCES Reservations(ReservationID) ON DELETE CASCADE
);

CREATE TABLE Reports (
    ReportID INT AUTO_INCREMENT PRIMARY KEY,
    ReportType ENUM('Reservations', 'Payments', 'Car Status') NOT NULL,
    GeneratedDate DATETIME DEFAULT CURRENT_TIMESTAMP,
    Details TEXT
);
